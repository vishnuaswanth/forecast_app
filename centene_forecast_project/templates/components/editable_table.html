{% load static custom_filters %}
{% comment %} <div class="container mt-5">
<table class="table table-bordered table-striped mt-2">
    <thead class='thead-dark'>
        <tr>
            {% for col in column_names %}
            <th>{{ col }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in page_obj %}
        <tr>
            {% for cell in row %}
            <td contenteditable="true" >{{ cell }}</td>
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr class="table-dark text-end">
          <td></td>
          <td></td>
          <td></td>
          <td>Total</td>
          <td>10</td>
          <td>10</td>
          <td></td>
        </tr>
      </tfoot>
</table>
<div class="d-flex justify-content-end mt-3">
    <div class="col-auto">
        <input type="submit" class="btn btn-info text-white" value="Save"/>
    </div>
</div>
</div>
 {% endcomment %}
 
 <style>
 .summary-row td {
     font-weight: bold;
     background-color: #f8f9fa !important;
 }
 .ramp-input-group {
     display: flex;
     align-items: center;
 }
 .ramp-input-group input {
     border-top-right-radius: 0;
     border-bottom-right-radius: 0;
     width: 70px;
 }
 .ramp-input-group .input-group-text {
     border-top-left-radius: 0;
     border-bottom-left-radius: 0;
     background-color: #f8f9fa;
 }
 .is-invalid {
     border-color: #dc3545 !important;
 }
 </style>
     <div class="card shadow">
         <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
             <h5 class="mb-0"></h5>
             <button id="saveBtn" class="btn btn-light">Save Changes</button>
         </div>
         <div class="card-body">
             <div class="table-responsive">
                 <table id="editableTable" class="table table-striped table-hover table-bordered">
                     <thead class="thead-light">
                         <tr>
                             {% for header in column_names %}
                                 <th scope="col">{{ header }}</th>
                             {% endfor %}
                         </tr>
                     </thead>
                     <tbody>
                         {% for row in page_obj %}
                             <tr data-row-index="{{ forloop.counter0 }}">
                                 {% for value in row %}
                                     <td>
                                         {% if forloop.counter0 == editable_indices.CPH %}
                                             <input type="number" class="form-control editable-field" 
                                                    data-field="CPH" value="{{ value }}" 
                                                    aria-label="CPH">
                                         {% elif forloop.counter0 == editable_indices.CDP %}
                                             <input type="number" class="form-control editable-field" 
                                                    data-field="CDP" value="{{ value }}"
                                                    aria-label="CDP">
                                         {% elif forloop.counter0 == editable_indices.Ramp %}
                                             <div class="ramp-input-group">
                                                 <input type="number" 
                                                        class="form-control editable-field" 
                                                        data-field="Ramp" 
                                                        value="{{ value|remove_percent }}" 
                                                        min="0" 
                                                        max="100"
                                                        step="5"
                                                        aria-label="Ramp">
                                                 <span class="input-group-text">%</span>
                                             </div>
                                         {% else %}
                                             {{ value }}
                                         {% endif %}
                                     </td>
                                 {% endfor %}
                             </tr>
                         {% endfor %}
                         
                         <tr class="summary-row table-info">
                             <td><strong>Total</strong></td>
                             <td colspan="3"></td>
                             <td class="summary-cph"><strong>0</strong></td>
                             <td class="summary-cdp"><strong>0</strong></td>
                             <td class="summary-ramp"></td>
                         </tr>
                     </tbody>
                 </table>
             </div>
         </div>
     </div>
 